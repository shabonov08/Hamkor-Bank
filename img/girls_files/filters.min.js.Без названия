mse2Config=mse2Config||{};var mSearch2={initialized:!1,loading:!1,reached:!1,options:{wrapper:"#mse2_mfilter",results:"#mse2_results",total:"#mse2_total",limit:"#mse2_limit",slider:".mse2_number_slider",filters:"#mse2_filters",filter_title:".filter_title",filter_wrapper:"fieldset",pagination:".mse2_pagination",pagination_link:".mse2_pagination a",sort:"#mse2_sort",sort_link:"#mse2_sort a",tpl:"#mse2_tpl",tpl_link:"#mse2_tpl a",selected:"#mse2_selected",selected_tpl:'<a href="#" data-id="_id_" class="mse2_selected_link"><em>_title_</em><sup>x</sup></a>',selected_wrapper_tpl:"<strong>_title_:</strong>",selected_filters_delimeter:"; ",selected_values_delimeter:" ",more:".btn_more",more_tpl:'<button class="btn btn-default btn_more">'+mse2Config.moreText+"</button>",active_class:"active",disabled_class:"disabled",disabled_class_fieldsets:"disabled_fieldsets",loading_class:"loading",reset_skip:["limit","sort","tpl"],prefix:"mse2_",suggestion:"span",autoLoad:!0},sliders:{},numbers:{},selections:{},numbersMasks:{},elements:["filters","results","pagination","total","sort","selected","limit","tpl"],initialize:function(e){if(this.initialized)return!1;if(void 0!=mse2Config.filterOptions&&Object.keys(mse2Config.filterOptions).length>0)for(t in mse2Config.filterOptions)mse2Config.filterOptions.hasOwnProperty(t)&&(this.options[t]=mse2Config.filterOptions[t]);for(t in this.elements)if(this.elements.hasOwnProperty(t)){var t,i=this.elements[t];this[i]=$(e).find(this.options[i])}0==this.pagination.length&&(this.options.pagination="#mse2_pagination",this.options.pagination_link="#mse2_pagination a",this.pagination=$(e).find(this.options.pagination)),this.handlePagination(),this.handleSort(),this.handleTpl(),this.handleNumbers(),this.handleSlider(),this.handleLimit();var s=$(this.options.filters+' [type="submit"]');for(t in this.options.autoLoad?($(document).on("change",this.options.filters,function(){return mSearch2.submit()}),s.addClass("hidden")):s.removeClass("hidden"),$(document).on("submit",this.options.filters,function(){return mSearch2.submit()}),this.btn_reset=$(this.options.filters+' [type="reset"]'),$(document).on("reset",this.options.filters,function(){return mSearch2.reset()}),this.startParams)if(this.startParams.hasOwnProperty(t)&&-1===this.options.reset_skip.indexOf(t)){this.btn_reset.removeClass("hidden");break}if(this.selected){this.selections[this.selected.text().replace(/\s+$/,"").replace(/:$/,"")]=[];var a=[this.options.filters+' input[type="checkbox"]',this.options.filters+' input[type="radio"]',this.options.filters+" select"];$(document).on("change",a.join(", "),function(){mSearch2.handleSelected($(this))}),a=['input[type="checkbox"]:checked','input[type="radio"]:checked',"select"],this.filters.find(a.join(", ")).each(function(){mSearch2.handleSelected($(this))}),$(document).on("click",this.options.selected+" a",function(){var e=$(this).data("id").replace(mse2Config.filter_delimeter,"\\"+mse2Config.filter_delimeter),t=$("#"+e);if(t[0])switch(t[0].tagName){case"INPUT":t.prop("checked",!1).trigger("change");break;case"SELECT":t.val(t.find("option:first").prop("value")).trigger("change")}return!1})}mSearch2.setEmptyFieldsets(),mSearch2.setTotal(this.total.text()),mSearch2.Hash.oldbrowser()||history.replaceState({mSearch2:window.location.href},"",document.location.href),window.setTimeout(function(){$(window).on("popstate",function(e){if(e.originalEvent.state&&e.originalEvent.state.mSearch2){var t={},i=e.originalEvent.state.mSearch2.split("?");if(i[1]){for(var s in i=i[1].split("&"))if(i.hasOwnProperty(s)){var a=i[s].split("=");t[a[0]]=a[1]}}mSearch2.setFilters(t),mSearch2.load(t)}})},1e3),this.initialized=!0},handlePagination:function(){var e=RegExp(mse2Config.pageVar+"[=|/|-](\\d+)");switch(mse2Config.mode){case"button":this.pagination.hide(),this.results.after(this.options.more_tpl);var t=$(this.options.more),i=!1;$(this.options.pagination_link).each(function(){var t=$(this).prop("href").match(e);if((t?t[1]:1)>mse2Config.page)return i=!0,!1}),i||t.hide(),mse2Config.page>1&&(mse2Config.page="",mSearch2.Hash.remove("page"),mSearch2.load()),$(document).on("click",this.options.wrapper+" "+this.options.more,function(e){e.preventDefault(),mSearch2.addPage()});break;case"scroll":this.pagination.hide();var s=$(this.options.wrapper),a=$(window);a.on("scroll",function(){!mSearch2.reached&&a.scrollTop()>s.height()-a.height()&&(mSearch2.reached=!0,mSearch2.addPage())}),mse2Config.page>1&&(mse2Config.page="",mSearch2.Hash.remove("page"),mSearch2.load());break;default:$(document).on("click",this.options.pagination_link,function(){if(!$(this).hasClass(mSearch2.options.active_class)){$(mSearch2.options.pagination).removeClass(mSearch2.options.active_class),$(this).addClass(mSearch2.options.active_class);var t=$(this).prop("href").match(e),i=t&&t[1]?Number(t[1]):1;mse2Config.page=i!=mse2Config.start_page?i:"";var s=mSearch2.getFilters();mSearch2.Hash.set(s),mSearch2.load(s,function(){$("html, body").animate({scrollTop:$(mSearch2.options.wrapper).position().top||0},0)})}return!1})}},handleSort:function(){var e=this.Hash.get();if(e.sort)for(var t=e.sort.split(mse2Config.values_delimeter),i=0;i<t.length;i++){var s=t[i].split(mse2Config.method_delimeter);s[0]&&s[1]&&$(this.options.sort_link+'[data-sort="'+s[0]+'"]').data("dir",s[1]).attr("data-dir",s[1]).addClass(this.options.active_class)}$(document).on("click",this.options.sort_link,function(){if($(this).hasClass(mSearch2.options.active_class)&&""==$(this).data("dir"))return!1;$(mSearch2.options.sort_link).removeClass(mSearch2.options.active_class),$(this).addClass(mSearch2.options.active_class),e=""==$(this).data("dir")?$(this).data("default"):"desc"==$(this).data("dir")?"asc":"desc",$(mSearch2.options.sort_link).data("dir","").attr("data-dir",""),$(this).data("dir",e).attr("data-dir",e);var e,t=$(this).data("sort");e&&(t=t.replace(RegExp(mse2Config.method_delimeter+".*?"+mse2Config.values_delimeter),mse2Config.method_delimeter+e+mse2Config.values_delimeter),t+=mse2Config.method_delimeter+e),mse2Config.sort=t!=mse2Config.start_sort?t:"";var i=mSearch2.getFilters();return mse2Config.page>1&&("scroll"==mse2Config.mode||"button"==mse2Config.mode)&&(mse2Config.page="",delete i.page),mSearch2.Hash.set(i),mSearch2.load(i),!1})},handleTpl:function(){$(document).on("click",this.options.tpl_link,function(){if(!$(this).hasClass(mSearch2.options.active_class)){$(mSearch2.options.tpl_link).removeClass(mSearch2.options.active_class),$(this).addClass(mSearch2.options.active_class);var e=$(this).data("tpl");mse2Config.tpl=e!=mse2Config.start_tpl&&0!=e?e:"";var t=mSearch2.getFilters();mse2Config.page>1&&("scroll"==mse2Config.mode||"button"==mse2Config.mode)&&(mse2Config.page="",delete t.page),mSearch2.Hash.set(t),mSearch2.load(t)}return!1})},handleSlider:function(){return!!$(mSearch2.options.slider).length&&($.ui&&$.ui.slider?($(mSearch2.options.slider).each(function(){for(var e=$(this),t=$(this).parents("fieldset"),i=t.find("input:first"),s=t.find("input:last"),a=Number(i.attr("value")),r=Number(s.attr("value")),l=Number(i.data("current-value")),o=Number(s.data("current-value")),n=i.val(),h=-1!=n.indexOf("."),c=h?Number(n.substr(n.indexOf(".")+1).length):0,d=1,p=1;p<=c;p++)d*=10;var m=i.prop("name");e.slider({min:a,max:r,values:[a,r],range:!0,step:1/d,stop:function(e,t){i.val(t.values[0].toFixed(c)),s.val(t.values[1].toFixed(c)),i.add(s).trigger("change"),mSearch2.sliders[m].user_changed=!0},change:function(e,t){void 0!=mSearch2.sliders[m]&&void 0!=mSearch2.sliders[m].values&&(mSearch2.sliders[m].changed=mSearch2.sliders[m].values[0]!=t.values[0].toFixed(c)||mSearch2.sliders[m].values[1]!=t.values[1].toFixed(c))},slide:function(e,t){h?(i.val(t.values[0].toFixed(c)),s.val(t.values[1].toFixed(c))):(i.val(t.values[0]),s.val(t.values[1]))}});var u=void 0!==mSearch2.Hash.get()[m];mSearch2.sliders[m]={changed:u,user_changed:u};var f=mSearch2.Hash.get();if(f[m]){var v=f[m].split(mse2Config.values_delimeter);v[0].match(/(?!^-)[^0-9\.]/g)&&(v[0]=v[0].replace(/(?!^-)[^0-9\.]/g,"")),v.length>1&&v[1].match(/(?!^-)[^0-9\.]/g)&&(v[1]=v[1].replace(/(?!^-)[^0-9\.]/g,"")),i.val(v[0]),s.val(v.length>1?v[1]:v[0])}i.attr("data-decimal",c),i.on("change keyup input click",function(t){this.value.match(/(?!^-)[^0-9\.]/g)&&(this.value=this.value.replace(/(?!^-)[^0-9\.]/g,"")),"keyup"!=t.type&&"input"!=t.type&&(this.value>r?this.value=r:this.value<a&&(this.value=a)),"change"==t.type&&(mSearch2.sliders[m].user_changed=!0),e.slider("values",0,this.value)}),s.attr("data-decimal",c),s.on("change keyup input click",function(t){this.value.match(/(?!^-)[^0-9\.]/g)&&(this.value=this.value.replace(/(?!^-)[^0-9\.]/g,"")),"keyup"!=t.type&&"input"!=t.type&&(this.value>r?this.value=r:this.value<a&&(this.value=a)),"change"==t.type&&(mSearch2.sliders[m].user_changed=!0),e.slider("values",1,this.value)}),f[m]&&i.add(s).trigger("click"),mSearch2.sliders[m].values=[a,r],isNaN(l)||isNaN(o)||(0!=l&&l!=a&&(e.slider("values",0,l),i.val(l)),0!=o&&o!=r&&(e.slider("values",1,o),s.val(o)),mSearch2.sliders[m].changed=void 0!==mSearch2.Hash.get()[m])}),!0):mSearch2.loadJQUI(mSearch2.handleSlider))},handleLimit:function(){$(document).on("change",this.options.limit,function(){var e=$(this).val();mse2Config.page="",e==mse2Config.start_limit?mse2Config.limit="":mse2Config.limit=e;var t=mSearch2.getFilters();mse2Config.page>1&&("scroll"==mse2Config.mode||"button"==mse2Config.mode)&&(mse2Config.page="",delete t.page),mSearch2.Hash.set(t),mSearch2.load(t)})},handleSelected:function(e){if(e[0]){var t,i,s=e.prop("id"),a="",r=e.parents(this.options.filter_wrapper),l="";if(r.length&&(i=r.find(this.options.filter_title)).length>0&&(l=i.text()),""==l)for(l in this.selections)break;switch(e[0].tagName){case"INPUT":var o=mSearch2.filters.find('label[for="'+e.prop("id")+'"]'),n=o.find("sup").text(),h=o.text().trim();a=n?h.replace(RegExp(n.replace("+","\\+")+"$"),""):h,$('[data-id="'+s+'"]',this.selected).remove(),e.is(":checked")&&(t=this.options.selected_tpl.replace("[[+id]]",s).replace("[[+title]]",a).replace("_id_",s).replace("_title_",a));break;case"SELECT":var c=e.find("option:selected");$('[data-id="'+s+'"]',this.selected).remove(),""!=e.val()&&(a=" "+c.text().replace(/(\(.*\)$)/,""),t=this.options.selected_tpl.replace("[[+id]]",s).replace("[[+title]]",a).replace("_id_",s).replace("_title_",a))}void 0!=t?((void 0==this.selections[l]||"radio"==e[0].type)&&(this.selections[l]={}),this.selections[l][s]=t):void 0!=this.selections[l]&&void 0!=this.selections[l][s]&&delete this.selections[l][s],this.selected.html("");var d=0,p=[];for(var m in this.selections)if(this.selections.hasOwnProperty(m)&&Object.keys(this.selections).length&&Object.keys(this.selections[m]).length){for(var u in i=[],this.selections[m])this.selections[m].hasOwnProperty(u)&&(i.push(this.selections[m][u]),d++);a=this.options.selected_wrapper_tpl.replace("[[+title]]",m).replace("_title_",m),p.push(a+i.join(this.options.selected_values_delimeter))}d?this.selected.append(p.join(this.options.selected_filters_delimeter)).show():this.selected.hide()}},handleNumbers:function(){var e={};$('input[type="text"],input[type="number"]',mSearch2.filters).each(function(){var t=$(this),i=t.attr("name");void 0==e[i]?e[i]=[t]:e[i].push(t),mSearch2.numbersMasks[i]=IMask(t[0],{mask:[{mask:""},{mask:"num",lazy:!1,blocks:{num:{mask:Number,scale:0,thousandsSeparator:" ",padFractionalZeros:!0,radix:",",mapToRadix:["я"]}}}]}),t.on("blur",function(){mSearch2.submit()})});var t=this.Hash.get();for(var i in e)if(e.hasOwnProperty(i)){var s=e[i];if(2==s.length){var a=s[0],r=s[1],l=a.val(),o=r.val();if(a.attr("data-original-value",l),r.attr("data-original-value",o),this.numbers[i]={values:[l,o]},void 0!=t[i]){var n=t[i].split(mse2Config.values_delimeter);2==n.length&&(a.val(n[0]),r.val(n[1]))}}}},load:function(e,t,i){if(this.loading)return!1;for(var s in this.loading=!0,this.btn_reset.addClass("hidden"),e)if(e.hasOwnProperty(s)&&-1===this.options.reset_skip.indexOf(s)){this.btn_reset.removeClass("hidden");break}e&&Object.keys(e).length||(e=this.getFilters()),e.action="filter",e.pageId=mse2Config.pageId,this.beforeLoad(),e.key=mse2Config.key,$.post(mse2Config.actionUrl,e,function(s){if(mSearch2.loading=!1,mSearch2.afterLoad(),s.success){mSearch2.Message.success(s.message),mSearch2.pagination.html(s.data.pagination),i?mSearch2.results.append(s.data.results):mSearch2.results.html(s.data.results),mSearch2.updateDropdowns(),"button"==mse2Config.mode?s.data.pages==s.data.page?$(mSearch2.options.more).hide():$(mSearch2.options.more).show():"scroll"==mse2Config.mode&&(mSearch2.reached=s.data.pages==s.data.page),mSearch2.setTotal(s.data.total),t&&$.isFunction(t)&&t.call(this,s,e),mSearch2.setSuggestions(s.data.suggestions),mSearch2.setEmptyFieldsets(),s.data.log&&$(".mFilterLog").html(s.data.log),mSearch2.updateTitle(s.data),$(document).trigger("mse2_load",s);var a=new CustomEvent("hamkorbank_filter_load",{detail:s});document.dispatchEvent(a)}else mSearch2.Message.error(s.message)},"json")},getFilters:function(){var e,t={},i=this.Hash.get();for(e in void 0!=i[mse2Config.idVar]&&(t[mse2Config.idVar]=i[mse2Config.idVar]),""!=mse2Config[mse2Config.queryVar]&&(t[mse2Config.queryVar]=mse2Config[mse2Config.queryVar]),""!=mse2Config[mse2Config.parentsVar]&&(t[mse2Config.parentsVar]=mse2Config[mse2Config.parentsVar]),""!=mse2Config.sort&&(t.sort=mse2Config.sort),""!=mse2Config.tpl&&(t.tpl=mse2Config.tpl),mse2Config.page>0&&(t.page=mse2Config.page),mse2Config.limit>0&&(t.limit=mse2Config.limit),$.map(this.filters.serializeArray(),function(e){""!==e.value&&(t[e.name]?parseFloat(String(e.value).replace(/[^0-9]/g,""))?t[e.name]+=mse2Config.values_delimeter+parseFloat(String(e.value).replace(/[^0-9]/g,"")):t[e.name]+=mse2Config.values_delimeter+e.value:t[e.name]=e.value)}),this.sliders)this.sliders.hasOwnProperty(e)&&t[e]&&!this.sliders[e].changed&&delete t[e];for(e in this.numbers){var s=this;this.numbers.hasOwnProperty(e)&&t[e]&&(Array.prototype.forEach.call(this.numbers[e].values,(t,i)=>{s.numbers[e].values[i]=parseFloat(String(t).replace(/[^0-9]/g,""))}),this.numbers[e].values.join(mse2Config.values_delimeter)==t[e]&&delete t[e])}return t},setFilters:function(e){for(var t in e||(e={}),this.elements){if(this.elements.hasOwnProperty(t)){var i,s,a,r,l,o=this.elements[t];if(void 0!==this[o])switch(o){case"limit":void 0==e.limit?(this.limit.val(mse2Config.start_limit),mse2Config.limit=""):this.limit.val(e.limit);break;case"pagination":mse2Config.page=void 0==e.page?"":e.page;break;case"sort":var n={};if(void 0==(a=e.sort)&&(a=mse2Config.start_sort,mse2Config.sort=""),"object"!=typeof a&&""!=a)for(t in a=a.split(mse2Config.values_delimeter))a.hasOwnProperty(t)&&(s=a[t].split(mse2Config.method_delimeter))[0]&&s[1]&&(n[s[0]]=s[1]);$(document).find(this.options.sort_link).each(function(){n[s=(i=$(this)).data("sort")]?(i.data("dir",n[s]).attr("data-dir",n[s]),i.addClass(mSearch2.options.active_class)):(i.data("dir","").attr("data-dir",""),i.removeClass(mSearch2.options.active_class))});break;case"tpl":a=void 0!=e.tpl?e.tpl:0,$(document).find(this.options.tpl_link).each(function(){(i=$(this)).data("tpl")==a?(i.addClass(mSearch2.options.active_class),mse2Config.tpl=a):i.removeClass(mSearch2.options.active_class)});break;case"filters":this.filters.find("input").each(function(){switch(s=(i=$(this)).prop("name"),l=i.prop("type"),void 0!=(a=e[s])&&"object"!=typeof a&&(a=a.split(mse2Config.values_delimeter)),l){case"checkbox":case"radio":var t=i.is(":checked");void 0!=e[s]?i.prop("checked",-1!=a.indexOf(String(i.val()))):i.prop("checked",!1),i.is(":checked")!=t&&mSearch2.handleSelected(i);break;default:if(mSearch2.sliders[s])(r=i.prop("id").match(/.*?_0$/)?void 0!=a&&void 0!=a[0]?a[0]:mSearch2.sliders[s].values[0]:void 0!=a&&void 0!=a[1]?a[1]:mSearch2.sliders[s].values[1])!=i.val()&&i.val(r).trigger("click");else{var o=i.data("original-value");void 0!=o&&i.val(o)}}}),this.filters.find("select").each(function(){s=(i=$(this)).prop("name"),l=i.prop("type"),void 0!=(a=e[s])?("object"!=typeof a&&(a=a.split(mse2Config.values_delimeter)),i.find("option").each(function(){var e=$(this);r=e.prop("value");var t=e.is(":selected");$(this).prop("selected",-1!=a.indexOf(String(r))),e.is(":selected")!=t&&mSearch2.handleSelected(i)})):i.val("")})}}}},setSuggestions:function(e){var t=mse2Config.aliases||{};for(var i in e)if(e.hasOwnProperty(i)){var s,a,r,l,o,n=void 0!==this.sliders[i],h=void 0!==this.numbers[i],c=e[i];if(s=i,void 0!==t[i]&&(i=t[i]),n&&!this.sliders[s].user_changed){var d=null,p=null;for(a in c)c.hasOwnProperty(a)&&"number"==typeof(r=c[a])&&(r>0&&(null===d||d>a)&&(d=Number(a)),r>0&&p<a&&(p=Number(a)));l=i.replace(mse2Config.filter_delimeter,"\\"+mse2Config.filter_delimeter);var m=$("#"+mSearch2.options.prefix+l+"_0",mSearch2.filters);m.length&&(null==d&&(d=Number(m.data("original-value"))),m.val(d.toFixed(m.data("decimal"))).trigger("click"));var u=$("#"+mSearch2.options.prefix+l+"_1",mSearch2.filters);u.length&&(null==p&&(p=Number(u.data("original-value"))),u.val(p.toFixed(u.data("decimal"))).trigger("click")),this.sliders[s].values=[d,p],this.sliders[s].changed=!1}else if(h);else for(a in c){if(c.hasOwnProperty(a)){if(r=c[a],l=CSS.escape(i),(o=$("#"+mSearch2.options.prefix+l,mSearch2.filters).find('[value="'+a.replace(/&quot;/g,'\\"')+'"]'))[0])switch(o[0].tagName){case"INPUT":var f=o.prop("type");if("checkbox"!=f&&"radio"!=f)continue;var v=$("#"+mSearch2.options.prefix+l,mSearch2.filters).find('label[for="'+o.prop("id")+'"]'),g=o.parent().find(mSearch2.options.suggestion);g.text(r),0==r?o.is(":not(:checked)")&&(o.prop("disabled",!0),v.addClass(mSearch2.options.disabled_class),mSearch2.handleSelected(o)):(o.prop("disabled",!1),v.removeClass(mSearch2.options.disabled_class)),o.is(":checked")?g.hide():g.show();break;case"OPTION":var S=o.text(),b=S.match(/\([^\)]+\)$/),k=b?b[0]:"",_="";r?(_=" ("+r+")",o.prop("disabled",!1).removeClass(mSearch2.options.disabled_class)):o.prop("disabled",!0).addClass(mSearch2.options.disabled_class),o.is(":selected")&&(_=""),k&&(S=S.replace(k,_)),o.text(S),o.attr("data-items-count",r),mSearch2.handleSelected(o.parent())}}}}},setEmptyFieldsets:function(){this.filters.find("fieldset").each(function(){var e=0==$(this).find("label:not(."+mSearch2.options.disabled_class+")").length;e&&$(this).addClass(mSearch2.options.disabled_class_fieldsets),!e&&$(this).hasClass(mSearch2.options.disabled_class_fieldsets)&&$(this).removeClass(mSearch2.options.disabled_class_fieldsets)})},setTotal:function(e){0!=this.total.length&&(e&&0!=e?(this.total.parent().show(),this.limit.parent().show(),this.sort.show(),this.total.text(e)):(this.total.parent().hide(),this.limit.parent().hide(),this.sort.hide(),this.total.text(0)))},beforeLoad:function(){$(this.options.wrapper).addClass(this.options.loading_class),this.results.css("opacity",.5),this.filters.find("input, select").prop("readonly",!0).addClass(this.options.disabled_class)},afterLoad:function(){var e=new CustomEvent("hamkorFilterAfterLoad",{});$(this.options.wrapper).removeClass(this.options.loading_class),this.results.css("opacity",1),this.filters.find("."+this.options.disabled_class).prop("readonly",!1).removeClass(this.options.disabled_class),document.dispatchEvent(e)},loadJQUI:function(e,t){return $("<link/>",{rel:"stylesheet",type:"text/css",href:mse2Config.cssUrl+"jquery-ui/jquery-ui.min.css"}).appendTo("head"),$.getScript(mse2Config.jsUrl+"lib/jquery-ui.min.js",function(){"function"==typeof e&&e(t)})},submit:function(e){if(this.loading)return!1;e&&Object.keys(e).length?(delete e.action,delete e.key,delete e.pageId):e=this.getFilters(),delete e.page;var t=$(this.options.filters).attr("action");if(mSearch2.options.autoLoad)return mse2Config.page="",mSearch2.Hash.set(e),mSearch2.load(e),!1;var i="";for(var s in e)e.hasOwnProperty(s)&&(i+="&"+s+"="+e[s]);return t.match(/\?/)?document.location=t+i:document.location=t+i.replace(/^&/,"?"),!1},reset:function(){if(this.loading)return!1;var e=this.Hash.get(),t={};for(var i in this.Hash.clear(),this.options.reset_skip)if(this.options.reset_skip.hasOwnProperty(i)){var s=this.options.reset_skip[i];void 0!=e[s]&&(t[s]=e[s])}for(var a in this.setFilters(t),this.sliders)this.sliders.hasOwnProperty(a)&&(this.sliders[a].changed=this.sliders[a].user_changed=!1);for(var r in mSearch2.numbersMasks)mSearch2.numbersMasks[r].unmaskedValue=mSearch2.numbersMasks[r].el.value;return this.submit()},addPage:function(){var e=RegExp(mse2Config.pageVar+"[=|/|-](\\d+)"),t=mse2Config.page||1;$(this.options.pagination_link).each(function(){var i=$(this).prop("href").match(e),s=i?Number(i[1]):1;if(s>t){mse2Config.page=s!=mse2Config.start_page?s:"";var a=mSearch2.getFilters();delete a.page,mSearch2.Hash.set(a);var r=mSearch2.getFilters();return mSearch2.load(r,null,!0),!1}})},updateTitle:function(e){if("undefined"!=typeof pdoTitle){for(var t=$("title"),i=pdoTitle.separator||" / ",s=pdoTitle.tpl,a=[],r=t.text().split(i),l=RegExp("^"+s.split(" ")[0]+" "),o=0;o<r.length;o++)1===o&&e.page&&e.page>1&&a.push(s.replace("{page}",e.page).replace("{pageCount}",e.pages)),r[o].match(l)||a.push(r[o]);t.text(a.join(i))}},updateDropdowns:function(){if(dropdownsObject)for(key in dropdownsObject)dropdownsObject[key].reInit()}};mSearch2.Form={initialized:!1,initialize:function(e){if(this.initialized||"undefined"==typeof mse2FormConfig)return!1;$(e).each(function(){var t=$(this),i=mse2FormConfig[t.data("key")],s={};if("0"==i.autocomplete||"false"==i.autocomplete)return!1;if(!$.ui||!$.ui.autocomplete)return mSearch2.loadJQUI(mSearch2.Form.initialize,e);let a=t.find('input[name="'+i.queryVar+'"]');return a.autocomplete({appendTo:$("#mse2_search_results"),source:function(e,a){var r=this;if(e.term in s){a(s[e.term]);return}var l={action:"search",key:t.data("key"),pageId:i.pageId};l[i.queryVar]=e.term,$.post(mse2Config.actionUrl,l,function(t){t.data.log?$(".mSearchFormLog").html(t.data.log):$(".mSearchFormLog").html(""),s[e.term]=t.data.results,0==t.data.results.length&&r.menu.element.html(`<div class="p-16 text-disabled">${siteConfig.lexicon.search.not_found}</div>`),a(t.data.results)},"json")},minLength:i.minQuery||3,select:function(e,i){i.item.url?document.location.href=i.item.url:setTimeout(function(){t.submit()},100)}}).data("ui-autocomplete")._renderItem=function(e,t){return $("<li>").data("item.autocomplete",t).addClass("mse2-ac-wrapper").append($("<div>").addClass("mse2-ac-link rounded-8 transition-all-300 overflow-hidden").html(t.label)).appendTo(e)},jQuery.ui.autocomplete.prototype._resizeMenu=function(){this.menu.element.outerWidth(this.element.outerWidth())},a.autocomplete("instance").menu._move=function(e,t,i){var s;this.active&&(s="first"===e||"last"===e?this.active["first"===e?"prevAll":"nextAll"](".ui-menu-item").last():this.active[e+"All"](".ui-menu-item").first()),s&&s.length&&this.active||(s=this._menuItems(this.activeMenu)[t]()),s[0].scrollIntoView({block:"nearest",inline:"nearest"}),this.focus(i,s)},document.querySelector("#mse2_search_results"),!0}),this.initialized=!0}},mSearch2.Message={success:function(e){},error:function(e){alert(e)}},mSearch2.Hash={get:function(){var e,t,i,s={};if(this.oldbrowser())i=decodeURIComponent(window.location.hash.substr(1)),t="/";else{var a=window.location.href.indexOf("?");i=-1!=a?decodeURIComponent(window.location.href.substr(a+1)):"",t="&"}if(0==i.length)return s;for(var r in i=i.split(t),i)i.hasOwnProperty(r)&&(void 0===(e=i[r].split("="))[1]?s.anchor=e[0]:s[e[0]]=e[1]);return s},set:function(e){var t,i="";for(t in e)e.hasOwnProperty(t)&&(i+="&"+t+"="+e[t]);if(this.oldbrowser())window.location.hash=i.substr(1);else{if(0!=i.length){i="?"+i.substr(1);var s={"%":"%25","+":"%2B"};for(t in s)s.hasOwnProperty(t)&&-1!==i.indexOf(t)&&(i=i.replace(RegExp("\\"+t,"g"),s[t]))}window.history.pushState({mSearch2:document.location.pathname+i},"",document.location.pathname+i)}},add:function(e,t){var i=this.get();i[e]=t,this.set(i)},remove:function(e){var t=this.get();delete t[e],this.set(t)},clear:function(){this.set({})},oldbrowser:function(){return!(window.history&&history.pushState)}},mSearch2.startParams=mSearch2.Hash.get();const resetFilter=document.querySelector(".reset-button");function count(e){return Object.keys(e).length}$("#mse2_tv\\|product_amount_0").val(0),$(document).on("mse2_load",function(e,t){$("#mse2_mfilter select").SelectInput("refresh"),0==count(mSearch2.getFilters())?(resetFilter.classList.add("bg-green","text-white"),resetFilter.classList.remove("bg-white","text-black")):(resetFilter.classList.remove("bg-green","text-white"),resetFilter.classList.add("bg-white","text-black"))}),resetFilter&&(count(mSearch2.startParams)&&(resetFilter.classList.remove("bg-green","text-white"),resetFilter.classList.add("bg-white","text-black")),resetFilter.addEventListener("click",()=>{(count(mSearch2.getFilters())>0||count(mSearch2.startParams)>0)&&(mSearch2.startParams={},$("#mse2_tv\\|product_amount_0").val(0),mSearch2.reset(),$("#mse2_mfilter input, #mse2_mfilter option").removeAttr("disabled"),$("#mse2_mfilter select").SelectInput("refresh"))}));